<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: README</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>README</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>README
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Thu Nov 13 15:17:11 +0100 2008</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h1><a href="../classes/Dynamime.html">Dynamime</a></h1>
<p>
Rails allows the creation of MIME type aliases to e.g. issue two different
HTML versions for different client devices. <a
href="../classes/Dynamime.html">Dynamime</a> extends this by adding
automatic device detection using the client browser&#8216;s user agent
string and the possibility to use cascading MIME type &quot;trees&quot;. If
e.g. a subset of mobile devices has special needs regarding some aspects of
a view, one can create special views for those devices while using more
generic views for other mobile devices that will also be used by the said
subset, if no special view was declared. This cascading can be used without
depth limitation.
</p>
<h2>Usage</h2>
<p>
Add this this line to the controller.
</p>
<pre>
    class ApplicationController &lt; ActionController::Base
      use_device_dependent_views
    end
</pre>
<p>
Requests coming from devices that are recognized as being special in some
way (i.e. there is a user agent string in the database that unambiuously
identifies the browser) the request format is set to whatever the
view_mime_type of that user agent is set to.
</p>
<p>
You can register allowed <a href="../classes/Dynamime.html">Dynamime</a>
types just as you register ordinary Mime types. However, <a
href="../classes/Dynamime.html">Dynamime</a> uses a cascading tree
structure with fallback views for its types. This means that you only have
to specify views for special devices if they really need an own view. If <a
href="../classes/Dynamime.html">Dynamime</a> detects e.g a mobile device
that only uses a special view for one view, the other views are still
rendered with its &quot;parent&quot; type, usually
&#8216;Mime::HTML&#8217;.
</p>
<p>
Consider the following line in config/initializers/mime_types.rb:
</p>
<pre>
    Dynamime::Type.register :mobile, :html, 'application/vnd.wap.xhtml+xml'
</pre>
<p>
If a mobile device is detected (see below) an it requests e.g. /users/1, <a
href="../classes/Dynamime.html">Dynamime</a> will now look for a view
template called /app/views/users/show.mobile.erb and render it. If that
template is not found, it will try to render /app/views/users/show.html.erb
before failing, if that one isn&#8216;t found either.
</p>
<p>
You can cascade this tree further like in the following example:
</p>
<pre>
    Dynamime::Type.register :mobile,    :html,     'application/xhtml+xml'
    Dynamime::Type.register :nokia_s60, :mobile
    Dynamime::Type.register :nokia_n95, :nokia_s60
</pre>
<p>
The MIME type string (will bes sent as &quot;Content-Type:&quot; in the
response header) is inherited from the &quot;parent&quot; type of a <a
href="../classes/Dynamime/Type.html">Dynamime::Type</a> if not specified.
</p>
<p>
<a href="../classes/Dynamime.html">Dynamime</a> works just as well with
`respond_to` as with explicit `render` methods.
</p>
<pre>
    # in UsersController
    def show
      # ... your app logic
      respond_to do |format|
        format.mobile
        format.nokia_s60
        format.nokia_n95
      end
    end
</pre>
<p>
Since it would be potentially tedious to explicitely list all supported
device dependent format.&lt;device&gt;-lines, dynamime does what it is
expected to do when simply using a `format.html` statement. It then creates
a responder for all &quot;subtypes&quot; of the &quot;html&quot; type, e.g:
</p>
<pre>
    # in UsersController
    def show
      # ... your app logic
      respond_to do |format|
        format.nokia_n95 {...} # special behaviour for this device
        format.html            # simple render for *all* other devices
      end
    end
</pre>
<p>
When using an explicit `render` statement (for actions, partials and the
whole other zoo), <a href="../classes/Dynamime.html">Dynamime</a> also
looks for &lt;template name&gt;.&lt;detected device&gt;.erb and uses the
same cascading.
</p>
<h2>Setting up <a href="../classes/Dynamime.html">Dynamime</a></h2>
<p>
After installing, you first have to create some tables needed by <a
href="../classes/Dynamime.html">Dynamime</a>. This is done by running
</p>
<pre>
    ruby script/generate dynamime_migration
    rake db:migrate
</pre>
<p>
The tables being created are:
</p>
<ul>
<li>browsers

</li>
<li>hardware_platforms

</li>
<li>user_agents

</li>
</ul>
<p>
The `view_mime_type` column in `user_agents` stores the name of the <a
href="../classes/Dynamime/Type.html">Dynamime::Type</a> that is to be used
for rendering views, if that user agent is detected.
</p>
<p>
[more blah]
</p>
<h2>Testing dynamimed Views</h2>
<p>
Just as usual if you want to force Rails into using a special format,
simply append the format to the url like /users/1.opera_mobile <a
href="../classes/Dynamime.html">Dynamime</a> will not try to determine the
client&#8216;s user agent for requests with an enforced format.
</p>
<p>
Written by Willem van Kerkhof for Vodafone Global Services &#8212; released
under the MIT license
</p>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>